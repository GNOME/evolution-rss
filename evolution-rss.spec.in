%define name evolution-rss
%define version @VERSION@
%define release 1

Summary: Evolution RSS Reader
Name:	 %{name}
Version: %{version}
Release: 1%{?dist}
Group: Applications/Internet
License: GPLv2+
Source: http://mips.edu.ms/%{name}-%{version}.tar.gz
BuildRoot: %{_tmppath}/%{name}-%{version}-%{release}-root
URL: http://mips.edu.ms/evo/index.php/Evolution_RSS_Reader_Plugin
#Patch: evolution-rss-%{version}.patch
Requires: evolution
Requires: firefox-devel
Requires: dbus
Requires: dbus-glib

Requires(post): GConf2
Requires(preun): GConf2

BuildRequires: gettext
BuildRequires: gettext-devel
BuildRequires: gcc-c++
BuildRequires: evolution-devel
BuildRequires: evolution-data-server-devel 
BuildRequires: dbus
BuildRequires: dbus-glib-devel
BuildRequires: perl(XML::Parser)

%description
This is an evolution plugin which enables evolution to read rss feeds.

%prep
%setup -q -n evolution-rss-%{version}
#%patch

%build
./configure --prefix="%{_prefix}" --sysconfdir="%{_sysconfdir}"  --libdir=%{_libdir} --disable-webkit
make %{?_smp_mflags}

%install
rm -rf %{buildroot}
make install DESTDIR="%{buildroot}"
find %{buildroot} -name \*\.la -print | xargs rm -f
%find_lang %{name}

%clean
rm -rf %{buildroot}

%post
export GCONF_CONFIG_SOURCE=`gconftool-2 --get-default-source`
gconftool-2 --makefile-install-rule \
	%{_sysconfdir}/gconf/schemas/evolution-rss.schemas >/dev/null
/sbin/ldconfig

%preun
export GCONF_CONFIG_SOURCE=`gconftool-2 --get-default-source`
gconftool-2 --makefile-uninstall-rule \
	%{_sysconfdir}/gconf/schemas/evolution-rss.schemas >/dev/null

%postun
/sbin/ldconfig

%files -f %{name}.lang
%defattr(-,root,root,-)
%{_prefix}/bin/evolution-import-rss
%{_sysconfdir}/gconf/schemas/evolution-rss.schemas
%{_datadir}/evolution/*/errors/org-gnome-evolution-rss.error
%{_datadir}/evolution/*/glade/rss-ui.glade
%{_datadir}/evolution/*/images/rss.png
%{_libdir}/evolution/*/plugins/org-gnome-evolution-rss.eplug
%{_libdir}/evolution/*/plugins/org-gnome-evolution-rss.xml
%{_libdir}/evolution/*/plugins/liborg-gnome-evolution-rss.so
%{_libdir}/bonobo/servers/GNOME_Evolution_RSS_*.server
%doc AUTHORS
%doc COPYING
%doc ChangeLog
%doc FAQ
%doc NEWS
%doc README
%doc TODO

%changelog
* Thu Jan 24 2008 Lucian Langa <lucilanga@gnome.org>
- Fixed rpmlint warnings
- Updated to Fedora Packaging Guidelines
* Thu Nov 22 2007 Lucian Langa <lucilanga@gnome.org>
- Added gconf schemas
- Added evolution-import-rss
* Tue Sep 04 2007 Lucian Langa <lucilanga@gnome.org>
- Updated installed files
* Mon Apr 23 2007 root <root@mayday>
- Initial spec file created by autospec ver. 0.8 with rpm 3 compatibility
